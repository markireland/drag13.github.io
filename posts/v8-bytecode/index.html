<!DOCTYPE html><html lang="en"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>How to get javascript bytecode from V8 and others in 2019</title><meta name="description" content="How to get bytecode for JavaScript using V8 and Node.JS with examples"><meta name="keywords" content="javascript performance v8 bytecode node.js"><link rel="canonical" href="https://drag13.io/posts/v8-bytecode/index.html"><meta name="application-name" content="Drag13 programmer's blog"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="author" content="Drag13"><meta name="robots" content="index follow"><meta name="application-name" content="Drag13 Dev Blog"><link rel="stylesheet" href="/common.91402137.css"><link rel="stylesheet" href="/post.abd2e44d.css"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144x144.183f717d.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="/apple-touch-icon-152x152.950bb193.png"><link rel="icon" type="image/png" href="/favicon-32x32.cf64321e.png" sizes="32x32"><link rel="icon" type="image/png" href="/favicon-16x16.65ddeb5a.png" sizes="16x16"><link rel="manifest" href="/manifest.webmanifest"><body><nav class="nav"><a href="/">Home</a><a href="https://github.com/Drag13"><svg height="32" viewBox="0 0 16 16" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></nav><main class="main"><div class="content markdown-body"><article><h1>How to get javascript bytecode from V8 and others in 2019</h1>
<p>Have you ever thought about how your javascript code looks like in bytecode? If yes, just follow the white rabbit.</p>
<p>Install latest Node.Js or check your current version using -v command. If it's 8.3 or above, everything is ok. If no, check the second part of this article.</p>
<p>Then run your code with a flag --print-bytecode. It will instruct the Node to display the bytecode directly to your console.</p>
<pre><code class="language-cmd">node --print-bytecode --eval <span class="token number">1</span>+1
</code></pre>
<p>After executing this command you will see a very long list with a code like this:</p>
<pre><code class="language-asm">Parameter count 2
Register count 3
Frame size 24
   12 E&gt; 000002252055F082 @    0 : a5                StackCheck
   33 S&gt; 000002252055F083 @    1 : 0b                LdaZero
         000002252055F084 @    2 : 26 fb             Star r0
</code></pre>
<blockquote>
<p>If you are curious about what it is and how to read this - here is a good <a href="https://medium.com/dailyjs/understanding-v8s-bytecode-317d46c94775">point to start</a>.</p>
</blockquote>
<p>But what if you want to see only some part of the code, let's say some function? Luckily, we have one more flag to filter bytecode by function's name ---print-bytecode-filter.</p>
<pre><code class="language-cmd">node --print-bytecode --print-bytecode-filter<span class="token operator">=</span>func_name my_javascript_file
</code></pre>
<p>I also pointed Node.Js to read code from my_javascript_file instead of evaluation. Another useful thing is that you can dump the result into another file with pipe operator (for PowerShell), so the final command can look like this:</p>
<pre><code class="language-cmd">node --print-bytecode --print-bytecode-filter<span class="token operator">=</span>func_name my_javascript_file <span class="token operator">&gt;</span> result.txt
</code></pre>
<p>And that's it - really simple, I would say! But we can do a bit deeper because sometimes this is not enough and there are two reasons for this:</p>
<p>First thing is that guys from Node.Js did a really awesome job and split Node.js out from the engine. This means that in real life, your Node.Js can use not V8 from Google team, but Chakra engine from Microsoft or SpiderMonkey or even something else! And you might want to see bytecode from a selected engine.</p>
<p>Another point is that when you use Node.Js, you always use production build which is reasonable. But in the release version, some interesting flags are hidden from us. For example, you can't get AST tree, you get a shorter version of the bytecode (yes, it can be even more detailed). So, if you want to get all the power, you should get a debug version of Node.Js.</p>
<p>For quite a long time before, to achieve this you had to download all related source code for the engine you wanted and compile it by yourself. This has been a real pain, especially for Windows users. But, times changed and thanks to the <a href="https://github.com/GoogleChromeLabs/jsvu">jsvu</a> team, we`ve got a really simple way to get any engine we need, even a debug version for V8. Thanks, guys, you are really awesome!</p>
<p>So, let's say you want to get V8's debug version. All you need is to run this simple command:</p>
<pre><code class="language-cmd">npx jsvu
</code></pre>
<p>And that's all! You will be prompted with a few questions (about OS, engines you want to get, etc) and then you will get all already built and ready engines you want! Isn't that awesome?</p>
<h2>More Useful flags</h2>
<ul>
<li>--print-ast will print Abstract Syntax Tree for your code (v8-debug only)</li>
<li>--print-opt-code/--print-opt-code-filter will print optimized code (really hard to read) (node, v8-debug)</li>
<li>--trace-turbo/--trace-turbo-filter - will show optimization filter for TurboFan compiler (any)</li>
<li>--print-code --print-code-verbose will print even more information for the code but has no filter for function name (any)</li>
</ul>
<p>If you want to see all the flags available for <a href="https://gist.github.com/Drag13/345136498ee2f2605f188f22d2258af0">v8</a> and <a href="https://gist.github.com/Drag13/92089a081a0056dd6872b77c2af88d94">v8-debug</a>, just check the links above. (Applicable for V8 v7.5.203)</p>
<h2>Useful links</h2>
<ul>
<li><a href="https://medium.com/dailyjs/understanding-v8s-bytecode-317d46c94775">Understanding bytecode from V8</a></li>
<li><a href="https://github.com/v8/v8/blob/master/src/interpreter/bytecodes.h">V8 bytescodes</a></li>
<li><a href="https://github.com/v8/v8/blob/master/src/interpreter/interpreter-generator.cc">V8 bytecodes with comments</a></li>
</ul>
<p>That's it guys, thanks for your time, hope you found this fun enough.</p>
</article></div></main><footer class="footer"><a href="https://github.com/Drag13/drag13.github.io/blob/development/LICENSE" target="_blank">2020 MIT by Drag13</a></footer></body></html>